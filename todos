1. change asserts, benchmarks
2. change edges and iv_table to rb_id_table, run benchmarks
3. [next week] memory profiling
4. preallocate shapes
